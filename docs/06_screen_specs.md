# 06 アプリ画面構成・テスト仕様

## 0. 初回設定フロー

### 0.1 概要

* **役割**: アプリ初回起動時に **1回だけ** 実行される初期設定フロー。
* **目的**: ユーザーに最適な初期レベルを推定し、即座に学習を開始できる状態にする。
* **UX原則**:
  * 🔴 **テスト感・評価感を出さない**
  * 🔴 **短く、迷わせない**
  * 2回目以降はスキップして直接ホームへ遷移する

### 0.2 フロー詳細

**Step 1: ようこそ（Welcome）**
* アプリのロゴと簡単な挨拶
* 「はじめる」ボタン

**Step 2: なまえ（Profile Name）**
* ニックネーム入力
* 用途：表示用、プロフィール識別
* 「あとで変更できます」

**Step 3: 学年（Grade）**
* 選択肢：
  * 年長以下
  * 小学1年生 〜 小学6年生
* **用途**: 算数・英語の初期レベル推定の基準（ベースライン）
* ※「学年＝絶対的レベル」とは扱わず、Step 5 で補正する

**Step 4: 学習する科目（Subject Mode）**
* 以下の選択肢からモードを決定
  * 🌈 **算数と英語**（推奨/デフォルト）
  * 🧮 **算数だけ**
  * 🔤 **英語だけ**
* 内部値: `subjectMode = "mix" | "math" | "vocab"`
* ※ 算数OFFの場合、Step 5 はスキップ

**Step 5: 算数 到達目安質問（Math Check）**
* **質問**: 「算数は、ここまでやったことがありますか？（学校でも、おうちでもOK）」
* **選択肢**（1つ選択）:
  1. 🔢 数をかぞえる・くらべる
  2. ➕ 足し算まで
  3. ➖ 引き算まで
  4. ✏️ 筆算（2けたのたし算・ひき算）
  5. ✖️ かけ算（九九）
* **意図**: テストではなく「自己申告」によるレベル補正（学年基準 ±5レベル）
* **表示**: ユーザーには内部数値（レベル）は一切見せない

**Step 6: 完了 → ホームへ**
* 設定完了演出
* ホーム画面へ遷移し、「おすすめ学習」からスタート

---

## 1. アプリ全体構成（IA）

### 1.1 タブ構成

本アプリは **下部タブ3構成** とする。

| タブ名  | 役割            |
| ---- | ------------- |
| ホーム  | 学習（即スタート）     |
| きろく  | 振り返り・目的を持った学習 |
| せってい | 管理・保護者向け      |

※「その他」タブは設けない
※ 学習開始導線は **ホームに一本化** する

### 1.3 言語トーン方針（Tone of Voice）

アプリのユーザー向け文言はすべて **「やさしい」トーン** で統一する。

* **原則**:
  * 命令・評価・比較を行わない
  * 親が隣で声をかけている温度感
* **NGワード**:
  * ❌ 「がんばろう」「まだ？」「できてない」「正解・不正解」「Wrong/Bad」
* **推奨ワード**:
  * ⭕ 「だいじょうぶ」「すこし」「ここまで」「やってみよ」「もういちど」

---

## 2. ホーム（＝学習）

### 2.1 役割

* アプリ起動後、**何も考えずに学習を開始できる場所**
* 判断・選択を極力排除する

### 2.2 機能

* 中央に大きな **「はじめる」ボタン**

  * デフォルト挙動：おすすめ学習（自動出題）
* 補助表示（小さく）

  * 科目切替（算数 / 英語）
  * 今日の学習量（任意）

### 2.3 進捗のひとこと（One-Liner Message）

「はじめる」ボタン付近に **1行だけ** メッセージを表示し、緩やかな継続感を演出する。常に1つだけ表示。

**文言パターン例（自動切替）**
* 🌱 **未学習**: 「きょうの いっぽんめ、やってみよ」「1もんだけでも だいじょうぶ」
* ✨ **学習中**: 「きょうは 5もん がんばったね」「もう すこし すすめたよ」
* 🔥 **連続**: 「3にち つづいてるよ。すごいね」「きのうも きょうも、えらいね」
* 🎉 **節目**: 「あと すこしで つぎのレベルだよ」「ここまで よく きたね」

---

### 2.4 置かない機能

* スキル一覧
* 苦手一覧
* 復習一覧
* 常設のテスト機能（評価・点数表示）
* 設定系機能

※ ホームは「考えさせない」ことを最優先とする

---

## 3. きろく

### 3.1 役割

* 学習結果の可視化
* 意図を持った学習（苦手・復習・確認）の起点

### 3.2 画面全体構造

縦スクロール可。
以下のセクションを **固定順** で配置する。

1. サマリー
2. 苦手
3. 復習
4. ✨定期テスト（イベント）

※ 各セクションは「対象がない場合は非表示」

---

### 3.3 サマリー

**目的：安心・把握（操作不可）**

表示内容例：

* 今日：解いた問題数 / 正答数
* 今週：学習日数 / 合計問題数

仕様：

* 原則タップ不可
* グラフ等は必須ではない
* 数値は最小限に抑える

---

### 3.4 苦手

**目的：最短で改善する**

表示条件：

* 苦手フラグが立っているスキルが1つ以上ある場合

表示内容：

* 苦手スキル名
* 正答率などの簡易指標
* **「これだけやる」ボタン**

挙動：

* 押下すると学習画面へ遷移
* 出題内容は該当スキルに固定
* 学習UI・演出は通常学習と同一

---

### 3.5 復習

**目的：忘却前の再定着**

表示条件：

* 忘却曲線等により復習対象が存在する場合

表示内容：

* 復習対象スキル
* 最終実施日など
* 「やってみる」ボタン

仕様：

* 苦手より優先度は低い
* 表示件数は少数（例：最大3件）

---

### 3.6 子ども向け「見るだけ」要素

きろく画面は基本的に保護者向けだが、子どもが見ても嫌にならない要素を **1つだけ** 置く。

* **案（自動バッジ）**:
  * ✨「3にち つづいたよ」
  * ✨「100もん こたえたよ」
  * ✨「テストのじかん だよ」
* ※ タップ不可・説明なし・自動付与

---

## 4. テスト・復習機能詳細（定期テスト・にがて復習）

### 4.1 基本方針

* **役割の分離**: 「測定（定期テスト）」と「準備（にがて復習）」を明確に分ける。
* **にがて復習**: テスト前の準備運動。思い出させることが目的。
* **定期テスト**: 学校の定期テストに近い正式な確認。

---

### 4.2 にがて復習（準備モード）

* **出現タイミング**: 定期テストの実施前（推奨）、または任意（将来拡張）。
* **目的**: 「一度触った」「思い出した」という状態を作る。
* **問題数**: 10問固定。
* **出題範囲**: 直後に控えている定期テストと同一範囲（現在のメインレベル所属スキル）。
* **出題優先度**:
    1. `weak`（苦手判定）
    2. `strength` が低い / 久しぶりのスキル
    3. テスト範囲内の重要スキル
* **仕様**:
    * 点数・合否なし
    * 時間計測なし
    * 途中スキップ可
    * **学習データへの影響**: `weak` 判定や復習優先度の更新を行う。

---

### 4.3 定期テスト（測定モード）

#### 4.3.1 位置づけ

* 学校の定期テストに近い **「正式な測定」**。
* 子ども・保護者が「できているか」を納得するための手段。

#### 4.3.2 実施形態（Online / Offline）

アプリ内（Online）と紙（Offline）は **同一のテスト内容** とする。

* **Online（アプリ内）**:
    * 時間計測：あり
    * 正誤確認：あり
    * 演出：完了時にファンファーレ等の演出（点数強調は控えめ）
* **Offline（PDF出力）**:
    * 家庭のプリンターで印刷して実施。
    * 内容はOnline版と完全に同一の生成ロジックを使用。

#### 4.3.3 内容詳細

* **問題数**: 20問固定。
* **出題範囲**: 現在のメインレベルに属するスキル集合。
    * ※ `weak` や `due` による重み付けは行わず、範囲内から **均等・ランダム** に出題する（純粋な測定のため）。
* **学習データへの影響**:
    * 解答結果は `active` 判定などに反映可。
    * **レベルアップ条件には使用しない**（あくまで確認用）。

#### 4.3.4 出現条件（イベント）

* **自動条件**:
    * 一定の学習量・期間に到達した際（例：レベルの区切り、月末など）。
* **手動条件**:
    * 保護者メニューから手動で「定期テストを作成」を実行可能。

---

## 5. レベルアップ・印刷（PDF）との関係

### 5.1 レベルアップ

* 条件：

  * 通常学習の累積（問題数・到達スキル）
* 使用しない情報：

  * ちからチェック結果
  * イベントちからチェック結果

---

### 5.2 PDF印刷

**記載するもの**

* 現在レベル
* 到達スキル一覧
* 定期テスト（20問） ※アプリ内定期テストと同一内容

※ 任意で
「確認チャレンジ 実施済」程度の注記は可

---

## 6. 遷移ルール（共通）

* 苦手 / 復習 / 定期テスト / にがて復習
  → **すべて同一の学習画面（または専用モード）に遷移**
* 学習終了後：

  * ホームへ戻る
  * きろくへ強制遷移しない

---

## 7. UX設計上の原則（明文化）

1. 学習開始導線は1つ（ホーム）
2. 結果はきろくに集約
3. 管理はせっていに隔離
4. テストは評価ではなく確認
5. 子どもを迷わせないことを最優先

---

## 9. メッセージ・共通表現カタログ

算数・英語で共通して使用する、評価を行わないやさしいフィードバック表現。

| 状況 | 使用表現 (Display Text) | 備考 |
|---|---|---|
| **正解** | ✨「そうだね」「あってるよ」「いいかんじ」 | 評価しない |
| **考えて正解** | ✨「ゆっくり かんがえられたね」 | |
| **復習で正解** | 🔁「おぼえてたよ」「ちゃんと のこってたね」 | |
| **ミス(前)** | 🌱「ちょっと ちがったね」「おしい ところ」 | 不正解と言わない |
| **ミス(後)** | 🌱「だいじょうぶ」「これは これだったよ」 | |
| **復習** | 🔁「さっきの ことばだよ」「もういちど みてみよ」 | |
| **スキップ** | 🌱「とばして だいじょうぶ」「また でてくるよ」 | |
| **区切り** | ✨「ここまで よく すすめたね」「いまの いいながれ」 | |

> **Note**: 将来的にキャラクターや世界観を導入する場合も、このトーンをベースにする。育成要素は現時点では実装しない。

---

## 8. せってい（Settings）

### 8.1 役割

* 保護者向け管理機能
* 学習体験のカスタマイズ
* プロフィール管理

### 8.2 機能一覧

| 項目 | 内容 | 備考 |
|---|---|---|
| **プロフィール管理** | 名前変更、新規作成、切替 | |
| **学習レベル調整** | 算数レベルの手動解放・調整 | **保護者機能（ガードあり）** |
| **科目設定** | 算数/英語/ミックスの切替 | |
| **BGM/SE** | 音量ON/OFF | |
| **データ管理** | 同期設定、バックアップ復元 | |

### 8.3 算数レベルの手動解放・調整（重要）

自動判定（レベルアップ）を補完するため、保護者が強制的にレベルを開放・閉鎖できる機能を提供する。

* **アクセス制限**:
  * 子供の誤操作を防ぐため、簡易的なガード（長押し、または計算問題など）を挟む。
* **UI**:
  * 全レベル（スキル）を一覧表示
  * 各レベルの状態（未解放 / 解放済 / 完了）を表示
  * タップ/スイッチで「解放済み上限」を手動変更できる
* **挙動ルール**:
  * ここで設定したレベルまでは即座に `unlocked=true` となる
  * 学習履歴（正答率など）はリセットせず**維持する**
  * 通常の自動レベルアップロジックも継続して動作する

