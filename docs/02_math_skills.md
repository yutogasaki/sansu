# 02 算数仕様書

算数コンテンツの定義仕様書

---

## 0. 目次

- [1. 基本方針](#1-基本方針)
- [2. スキル採用判定](#2-スキル採用判定)
- [3. 採用スキル一覧（レベル順）](#3-採用スキル一覧レベル順)
- [4. レベル定義](#4-レベル定義)
- [5. 入力UI仕様](#5-入力ui仕様)
- [6. データ構造](#6-データ構造)

---

## 0. この仕様書の位置づけ

### 0.1 役割

このドキュメントは、算数の**コンテンツ定義**および**基本UI仕様**を定義する。
詳細な問題生成ルールは [04_math_problems.md](./04_math_problems.md) を参照。

| 定義する内容 | 定義しない内容（親を参照） |
|---|---|
| 採用するスキル一覧 | 解放条件（正答率85%） |
| レベルとスキルの対応 | **ステータス管理（Active/Retired）** |
| 入力仕様（UI） | 記憶強度アルゴリズム |
| データ構造（算数固有） | ユーザーデータ全体 |

### 0.2 関連仕様書

| No. | ファイル名 | 参照する内容 |
|---|---|---|
| 01 | 01_app_spec.md | 解放条件、**ステータス管理**、忘却曲線、共通UI |
| 04 | 04_math_problems.md | 詳細な問題生成ルール |

---

## 1. 基本方針

### 1.1 コンセプト

**公文式のように「計算力」に特化**

- 四則演算、分数、小数の計算スキルを段階的に習得
- 図形・文章題・グラフは扱わない
- 「考える」より「手が動く」トレーニング

### 1.2 対象範囲

| 項目 | 内容 |
|---|---|
| 対象学年 | 小学1〜6年 |
| スキル数 | 全58スキル（20レベルに分類） |
| 出題形式 | 数字入力（テンキー） |

---

## 2. スキル採用判定

（詳細は概念レベルのため省略せず残すが、後方参照のため簡略化してもよい。ここでは現状維持。）

（中略：採用・不採用の議論ログはそのまま保持）

---

## 3. 採用スキル一覧（レベル順）

各スキルは正答率85%で次が解放される（01仕様書参照）。
レベル順に習得することを想定している。

| レベル | No. | カテゴリ | スキル名 | ID | inputType |
|---:|---:|---|---|---|---|
| 1 | 1 | 数の基礎 | 数を数える（1-10） | count_10 | single |
| 2 | 2 | 数の基礎 | 数を数える（1-50） | count_50 | single |
| 3 | 3 | 数の基礎 | 数を数える（1-100） | count_100 | single |
| 3 | 4 | 数の基礎 | 数の順番（穴埋め） | count_fill | single |
| 3 | 5 | 数の基礎 | 大小比較（1桁） | compare_1d | choice |
| 3 | 6 | 数の基礎 | 大小比較（2桁） | compare_2d | choice |
| 4 | 7 | 足し算 | +1〜+3（1桁） | add_1d_1 | single |
| 5 | 8 | 足し算 | +4〜+10（1桁） | add_1d_2 | single |
| 6 | 15 | 引き算 | 1桁-1桁（繰下なし） | sub_1d1d_nc | single |
| 6 | 16 | 引き算 | 1桁-1桁（繰下あり） | sub_1d1d_c | single |
| 7 | 9 | 足し算 | 2桁+1桁（繰上なし） | add_2d1d_nc | single |
| 7 | 10 | 足し算 | 2桁+1桁（繰上あり） | add_2d1d_c | single |
| 7 | 17 | 引き算 | 2桁-1桁（繰下なし） | sub_2d1d_nc | single |
| 7 | 18 | 引き算 | 2桁-1桁（繰下あり） | sub_2d1d_c | single |
| 7 | 11 | 足し算 | 2桁+2桁（繰上なし） | add_2d2d_nc | single |
| 7 | 12 | 足し算 | 2桁+2桁（繰上あり） | add_2d2d_c | single |
| 7 | 19 | 引き算 | 2桁-2桁 | sub_2d2d | single |
| 8 | 13 | 足し算 | 3桁+3桁 | add_3d3d | single |
| 8 | 20 | 引き算 | 3桁-3桁 | sub_3d3d | single |
| 8 | 14 | 足し算 | 4桁以上 | add_4d | single |
| 8 | 21 | 引き算 | 4桁以上 | sub_4d | single |
| 9 | 22 | 掛け算 | 九九（2の段） | mul_99_2 | single |
| 9 | 23 | 掛け算 | 九九（3の段） | mul_99_3 | single |
| 9 | 24 | 掛け算 | 九九（4の段） | mul_99_4 | single |
| 9 | 25 | 掛け算 | 九九（5の段） | mul_99_5 | single |
| 9 | 30 | 掛け算 | 九九（1の段） | mul_99_1 | single |
| 10 | 26 | 掛け算 | 九九（6の段） | mul_99_6 | single |
| 10 | 27 | 掛け算 | 九九（7の段） | mul_99_7 | single |
| 10 | 28 | 掛け算 | 九九（8の段） | mul_99_8 | single |
| 10 | 29 | 掛け算 | 九九（9の段） | mul_99_9 | single |
| 10 | 31 | 掛け算 | 九九ランダム | mul_99_rand | single |
| 11 | 32 | 掛け算 | 2桁×1桁 | mul_2d1d | single |
| 11 | 33 | 掛け算 | 3桁×1桁 | mul_3d1d | single |
| 12 | 36 | 割り算 | 割り切れる（九九逆） | div_99_rev | single |
| 12 | 37 | 割り算 | 2桁÷1桁（割切） | div_2d1d_exact | single |
| 13 | 38 | 割り算 | 余りあり（商1桁） | div_rem_q1 | multi |
| 13 | 39 | 割り算 | 余りあり（商2桁） | div_rem_q2 | multi |
| 14 | 34 | 掛け算 | 2桁×2桁 | mul_2d2d | single |
| 14 | 35 | 掛け算 | 3桁×2桁 | mul_3d2d | single |
| 14 | 40 | 割り算 | 2桁÷2桁 | div_2d2d_exact | single |
| 14 | 41 | 割り算 | 3桁÷1桁 | div_3d1d_exact | single |
| 14 | 42 | 割り算 | 3桁÷2桁 | div_3d2d_exact | single |
| 15 | 43 | 小数 | 小数の足し算 | dec_add | single |
| 15 | 44 | 小数 | 小数の引き算 | dec_sub | single |
| 16 | 45 | 小数 | 小数×整数 | dec_mul_int | single |
| 16 | 46 | 小数 | 小数÷整数 | dec_div_int | single |
| 16 | 47 | 小数 | 小数×小数 | dec_mul_dec | single |
| 16 | 48 | 小数 | 小数÷小数 | dec_div_dec | single |
| 17 | 49 | 分数 | 同分母の足し算 | frac_add_same | multi |
| 17 | 50 | 分数 | 同分母の引き算 | frac_sub_same | multi |
| 18 | 51 | 分数 | 異分母の足し算 | frac_add_diff | multi |
| 18 | 52 | 分数 | 異分母の引き算 | frac_sub_diff | multi |
| 18 | 53 | 分数 | 帯分数の計算 | frac_mixed | multi |
| 19 | 54 | 分数 | 分数×整数 | frac_mul_int | multi |
| 19 | 56 | 分数 | 分数×分数 | frac_mul_frac | multi |
| 20 | 55 | 分数 | 分数÷整数 | frac_div_int | multi |
| 20 | 57 | 分数 | 分数÷分数 | frac_div_frac | multi |
| 20 | 58 | その他 | 10倍、100倍、1/10 | scale_10x | single |

---

## 4. レベル定義

各レベルの学習目標概要。

| レベル | 名称 | 概要 | スキル数 |
|---|---|---|---|
| 1 | 数える（基礎） | 10までの数 | 1 |
| 2 | 数える（発展） | 50までの数 | 1 |
| 3 | 数の感覚 | 100までの数、順序、大小 | 4 |
| 4 | 足し算（入門） | 1桁の足し算（+3まで） | 1 |
| 5 | 足し算（基礎） | 1桁の足し算（+10まで） | 1 |
| 6 | 引き算（1桁） | 1桁の引き算 | 2 |
| 7 | 足し引き（2桁） | 2桁の足し算・引き算 | 7 |
| 8 | 足し引き（3桁以上） | 3桁以上の筆算 | 4 |
| 9 | 九九（前半） | 1〜5の段 | 5 |
| 10 | 九九（後半） | 6〜9の段、ランダム | 5 |
| 11 | 掛け算（筆算） | ×1桁の筆算 | 2 |
| 12 | 割り算（基礎） | 割り切れる計算 | 2 |
| 13 | 割り算（余りあり） | 余りのある計算 | 2 |
| 14 | 掛け割り（大きな数） | まとまった桁数の掛け割り | 5 |
| 15 | 小数（足し引き） | 小数の加減 | 2 |
| 16 | 小数（掛け割り） | 小数の乗除 | 4 |
| 17 | 分数（同分母） | 同分母の加減 | 2 |
| 18 | 分数（異分母） | 異分母の加減、帯分数 | 3 |
| 19 | 分数（掛け算） | 分数の掛け算 | 2 |
| 20 | 分数（割り算） | 分数の割り算・倍数変化 | 3 |

---

## 5. 入力UI仕様

### 5.1 入力方式

| 問題タイプ | 入力方式 | UI |
|---|---|---|
| 整数 | テンキー | 0-9 + 決定 + クリア |
| 小数 | テンキー + 小数点 | 0-9 + . + 決定 + クリア |
| 分数 | 分数パッド | 分子入力 → 分母入力 → 決定 |
| 帯分数 | 帯分数パッド | 整数 → 分子 → 分母 → 決定 |
| 余りあり | 商・余りパッド | 商入力 → 余り入力 → 決定 |
| 大小比較 | 3択 | > = < ボタン |
| 数を数える | テンキー | 0-9 + 決定 |

### 5.2 テンキーUI

```
┌─────────────────────────┐
│      問題: 23 + 45      │
│                         │
│        [ 68 ]           │  ← 入力中の答え
│                         │
├─────────────────────────┤
│  ┌───┐ ┌───┐ ┌───┐     │
│  │ 7 │ │ 8 │ │ 9 │     │
│  └───┘ └───┘ └───┘     │
│  ┌───┐ ┌───┐ ┌───┐     │
│  │ 4 │ │ 5 │ │ 6 │     │
│  └───┘ └───┘ └───┘     │
│  ┌───┐ ┌───┐ ┌───┐     │
│  │ 1 │ │ 2 │ │ 3 │     │
│  └───┘ └───┘ └───┘     │
│  ┌───┐ ┌───┐ ┌───┐     │
│  │ C │ │ 0 │ │ ✓ │     │
│  └───┘ └───┘ └───┘     │
└─────────────────────────┘
```

### 5.3 分数入力UI

```
┌─────────────────────────┐
│    問題: 1/2 + 1/3      │
│                         │
│        [ 5 ]            │  ← 分子
│       ─────             │
│        [ 6 ]            │  ← 分母
│                         │
├─────────────────────────┤
│  分子 ←→ 分母  切替     │
│  テンキー + 決定         │
└─────────────────────────┘
```

### 5.4 スキップ

- 左スワイプでスキップ
- 答えを表示してから次の問題へ
- 記憶強度は1にリセット

---

## 6. データ構造

### 6.1 スキル定義

```typescript
interface MathSkill {
  id: string;              // "add_1d_1"
  name: string;            // "+1〜+3（1桁）"
  level: number;           // 4
  category: MathCategory;  // "addition"
  inputType: InputType;    // "numpad"
  // generate関数は実装時に 04_math_problems.md の仕様に基づいて実装する
}

type MathCategory = 
  | "counting"      // 数の基礎
  | "addition"      // 足し算
  | "subtraction"   // 引き算
  | "multiplication"// 掛け算
  | "division"      // 割り算
  | "decimal"       // 小数
  | "fraction";     // 分数

type InputType = 
  | "numpad"        // 整数テンキー
  | "decimal"       // 小数テンキー
  | "fraction"      // 分数パッド
  | "mixed"         // 帯分数パッド
  | "remainder"     // 商・余りパッド
  | "comparison";   // 大小比較（3択）
```

---

作成日: 2026年1月15日
最終更新: 2026年1月31日
